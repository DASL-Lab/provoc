<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="provoc">
<title>ProVoC Mission Statement • provoc</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ProVoC Mission Statement">
<meta property="og:description" content="provoc">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">provoc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Package_Overview.html">ProVoC Mission Statement</a>
    <a class="dropdown-item" href="../articles/mutation_definitions.html">Lineage Definitions in ProVoC</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>ProVoC Mission Statement</h1>
                        <h4 data-toc-skip class="author">Devan
Becker</h4>
            
      
      
      <div class="d-none name"><code>Package_Overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="purpose">Purpose<a class="anchor" aria-label="anchor" href="#purpose"></a>
</h2>
<p>ProVoC is intended as an exploratory tool to investigate and validate
the input and results of a lineage proportion estimation pipeline. This
tool implements various diagnostic tests for the input data and the
model results.</p>
<p>The primary aims of the package are:</p>
<ol style="list-style-type: decimal">
<li>Exploration of the data
<ul>
<li>mutation frequency, coverage, lineage defining mutations</li>
</ul>
</li>
<li>Exploration of the discoverability of lineages within wastewater
<ul>
<li>For example, whether the mutations required to differentiate BA.1
from BA.2 are present in the wastewater in large enough quantities.</li>
</ul>
</li>
<li>Estimation of proportions of lineages of concern</li>
<li>Model diagnostics that work for any of the common estimation
procedures (Freyja, Alcov, etc.).</li>
</ol>
<p>Our intent is to facilitate a standardized approach to the assessment
of model results for wastewater data.</p>
</div>
<div class="section level2">
<h2 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h2>
<p>ProVoC is designed for data with the following format:</p>
<table class="table">
<caption>Input data, as processed from short read sequencing of
wastewater samples.</caption>
<colgroup>
<col width="12%">
<col width="11%">
<col width="22%">
<col width="14%">
<col width="12%">
<col width="8%">
<col width="17%">
</colgroup>
<thead><tr class="header">
<th align="right">position</th>
<th align="left">label</th>
<th align="left">mutation</th>
<th align="right">frequency</th>
<th align="right">coverage</th>
<th align="right">count</th>
<th align="left">sra</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">912</td>
<td align="left">~913T</td>
<td align="left">C913T</td>
<td align="right">0.4356255</td>
<td align="right">2734</td>
<td align="right">1191</td>
<td align="left">SRR15505102</td>
</tr>
<tr class="even">
<td align="right">23062</td>
<td align="left">~23063T</td>
<td align="left">aa:S:N501Y</td>
<td align="right">0.0005126</td>
<td align="right">3902</td>
<td align="right">2</td>
<td align="left">SRR15505102</td>
</tr>
<tr class="odd">
<td align="right">5647</td>
<td align="left">~5648C</td>
<td align="left">aa:orf1a:K1795Q</td>
<td align="right">0.0000931</td>
<td align="right">10742</td>
<td align="right">1</td>
<td align="left">SRR15505102</td>
</tr>
<tr class="even">
<td align="right">16175</td>
<td align="left">~16176C</td>
<td align="left">T16176C</td>
<td align="right">0.0000000</td>
<td align="right">16765</td>
<td align="right">0</td>
<td align="left">SRR15505102</td>
</tr>
</tbody>
</table>
<p>Note a couple of things:</p>
<ul>
<li>“count” is the number of times a mutation was observed. “coverage”
is the read depth at the loci of a mutation.</li>
<li>There is both a “label” and “mutation” column. ProVoC includes some
functions to create standardized names for mutations to ensure smooth
modelling. (Also note that position is 0-indexed, but label and mutation
are one-indexed. This is not a requirement, but important to keep in
mind.)</li>
<li>There are multiple samples in the same data frame. ProVoC is set up
to work with this - it will apply the model separately to each unique
sample.</li>
<li>These data have some mutations with a frequency of zero. These data
were processed specifically to include mutations that were common in at
least one sample, even if they weren’t observed in other samples. This
is not a requirement of the package, but it’s recommended practice when
there are multiple samples.</li>
<li>The column names are not required to be the same as above. ProVoC is
compatible with the output of the iVar pipeline.</li>
</ul>
<p>ProVoC also requires the definition of lineages such as:</p>
<table class="table">
<caption>Lineage definitions in a format (a matrix) compatible with
common modelling frameworks.</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">B.1.1.7</th>
<th align="right">B.1.617.2</th>
<th align="right">P.1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">C913T</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">aa:S:N501Y</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">aa:orf1a:K1795Q</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">T16176C</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>Within <code>provoc</code> there are hard-coded historical
definitions based on <a href="https://github.com/cov-lineages/constellations" class="external-link">constellations</a>
from the team that defined the PANGO lineages, and there is a function
to download and store the Usher Barcodes used by Freyja.</p>
<p>The user can specify their own definitions as well. For most of the
functions and all estimation techniques, the values can be fractional.
That is, a mutation can be in 30% of all B.1.1.7 cases. This is not
discussed in this document, but a future version of the package will
account for this.</p>
</div>
<div class="section level2">
<h2 id="modelling">Modelling<a class="anchor" aria-label="anchor" href="#modelling"></a>
</h2>
<div class="section level3">
<h3 id="basic-modelling">Basic Modelling<a class="anchor" aria-label="anchor" href="#basic-modelling"></a>
</h3>
<p>All models for wastewater data that we have come across are
generalizations of a linear modelling framework.</p>
<p>Essentially, the estimate of a proportion for B.1.1.7 amounts to
fitting a linear model of frequency versus the lineage definitions,
i.e. using <code>frequency</code> as the response variable and
<code>B.1.1.7</code>, <code>B.1.617.2</code>, and <code>P.1</code> as
the covariates.</p>
<table class="table">
<caption>Data format useful for basic linear regression</caption>
<thead><tr class="header">
<th align="left"></th>
<th align="right">frequency</th>
<th align="right">coverage</th>
<th align="right">B.1.1.7</th>
<th align="right">B.1.617.2</th>
<th align="right">P.1</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">C913T</td>
<td align="right">0.4356255</td>
<td align="right">2734</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">aa:M:I82T</td>
<td align="right">0.0000623</td>
<td align="right">32111</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">aa:orf1a:A1708D</td>
<td align="right">0.0005299</td>
<td align="right">28308</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">aa:orf8:R52I</td>
<td align="right">0.0004635</td>
<td align="right">6472</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">C26801T</td>
<td align="right">0.0000628</td>
<td align="right">31832</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">aa:S:A570D</td>
<td align="right">0.0002755</td>
<td align="right">14517</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p>The regression equation from a linear regression becomes: <span class="math display">\[
f = count / coverage = \beta_\alpha B.1.1.7 + \beta_\delta B.1.617.2 +
\beta_\gamma P.1
\]</span> In other words, a mutation that is present in only B.1.1.7
(i.e., when B.1.617.2 and P.1 are both 0) is estimated to have a
frequency equal to <span class="math inline">\(\beta_\alpha\)</span>,
which amounts to saying that <span class="math inline">\(\beta_\alpha\)</span> represents the proportion of
B.1.1.7 in the sample. The linear modelling framework accounts for
shared mutations, adjusting the estimates of proportions appropriately.
Note that there is no intercept in this model - there is no physical
interpretation of an intercept, and no model should include it.</p>
<p>There are two main problems with this approach, along with a bonus
third problem:</p>
<ol style="list-style-type: decimal">
<li>The estimates can be negative, which should not be allowed for
proportions.</li>
<li>The estimates might add to something more than 1, which again is
invalid for proportions.</li>
<li>(Bonus) most of the modelling diagnostics for a linear regression
model are based on the normality assumption. Since the frequency of a
mutation must be between 0 and 1, this assumption is not valid. This is
not a problem with the estimates, but means we can’t use the usual
linear regression tools for checking our model’s fits.</li>
</ol>
</div>
<div class="section level3">
<h3 id="provoc-alcov-and-freyja">ProVoC, Alcov, and Freyja<a class="anchor" aria-label="anchor" href="#provoc-alcov-and-freyja"></a>
</h3>
<p>The extensions to linear models are as follows:</p>
<ul>
<li>The main <code>provoc</code> function fits a Binomial GLM with
constraints on the parameters.
<ul>
<li>The number of observed mutations (count) is assumed to come from a
binomial distribution, where the number of trials comes from the
coverage and the probability of success is estimated the same as the
linear model. That is, the count of a mutation in B.1.1.7 should be
approximately equal to the proportion of B.1.1.7 times the coverage of
the mutation.</li>
<li>The binomial distribution accounts for the coverage of each
mutation, while estimating the proportions in the same way as other
models.</li>
<li>The estimation routine ensures that the proportions are positive and
sum to less than 1.</li>
</ul>
</li>
<li>Freyja adjusts the frequencies and lineage definitions according to
the coverage and then fits a Lasso model, which attempts to “shrink”
proportions of the lineages to 0.
<ul>
<li>The adjustment for coverage essentially gives mutations with more
coverage a higher “weight”; errors in estimating mutations with low
coverage are not penalized as much when fitting the model.</li>
<li>LASSO regression implementation ensures proportions are positive. It
adjusts the proportions if they happen to sum to more than 1.</li>
</ul>
</li>
<li>Alcov fits a robust linear regression model, essentially modelling
the median of the frequency for each mutation while accounting for
mutations that are shared between lineages.
<ul>
<li>Uses non-negative regression to ensure positive parameter estimates
and uses a jacknife-like scheme to find parameter estimates that satisfy
the “sum-to-less-than-one” constraing.</li>
</ul>
</li>
</ul>
<p>Currently, only ProVoC is implemented, but base versions of Freyja
and Alcov are being implemented to allow comparison across models.</p>
</div>
</div>
<div class="section level2">
<h2 id="diagnostics-for-lineage-proportion-estimation">Diagnostics for Lineage Proportion Estimation<a class="anchor" aria-label="anchor" href="#diagnostics-for-lineage-proportion-estimation"></a>
</h2>
<div class="section level3">
<h3 id="data-only">Data-Only<a class="anchor" aria-label="anchor" href="#data-only"></a>
</h3>
<p>The methods described in this section are applicable if we only have
access to the input data.</p>
<div class="section level4">
<h4 id="matching-data-to-lineage-definitions">Matching Data to Lineage Definitions<a class="anchor" aria-label="anchor" href="#matching-data-to-lineage-definitions"></a>
</h4>
<p>We can only model mutations for which we have a lineage definition.
Conversely, we can only use lineage definitions for mutations in the
model. For the data above, there are 773 unique mutations in the data
and 51 mutations for which we have lineage assignments. In an ideal
world, this would mean that we are modelling based on 51 mutations.
However,</p>
<ul>
<li>There are 749 mutations in the data don’t appear in the lineage
definitions.</li>
<li>There are 27 mutations that we have lineage definitions for which do
not appear in the data.</li>
</ul>
<p>We are left with only 24 mutations from the data that also appear in
the lineage definitions. This is important information to know prior to
modelling.</p>
<p>A separate problem occurs when the lineage definitions are too
similar. Suppose lineage X contains mutations m1, m2, and m3, and
lineage Y contains mutations m2, m3, and m4. These two lineages both
contain m2 and m3, so we need to know about m1 and m4 to distinguish
them. If mutations m1 and m4 have no coverage in the data, then lineages
X and Y are indistinguishable.</p>
<p><code>provoc</code> includes a function <code><a href="../reference/fuse.html">fuse()</a></code> that
presents this information to the user to help them make informed
decisions about the modelling process.</p>
</div>
</div>
<div class="section level3">
<h3 id="model-and-data">Model and Data<a class="anchor" aria-label="anchor" href="#model-and-data"></a>
</h3>
<p>The methods in this section apply if we have access to the data and
can re-run the analyses as needed. Note that the <code><a href="../reference/provoc.html">provoc()</a></code>
function works similarly to other methods and can be used for many of
these investigations even if other methods are used.</p>
<div class="section level4">
<h4 id="confidence-intervals-for-model-parameters">Confidence Intervals for Model Parameters<a class="anchor" aria-label="anchor" href="#confidence-intervals-for-model-parameters"></a>
</h4>
<p>For the normal linear model with no constraints, we can obtain the
variance of the regression coefficients (<span class="math inline">\(\underline\beta\)</span>) using the formula <span class="math inline">\((X^TX)^{-1}\sigma^2\)</span>, where <span class="math inline">\(X\)</span> is the lineage definition matrix above
and <span class="math inline">\(\sigma^2\)</span> is the variance of the
response variable. This can be used to create confidence intervals, but
only if we assume that the response is normally distributed. This is not
the case for the models discussed here.</p>
<p>Instead, we have two options: either use these anyway and check them
after the model has been fit, or use bootstrapping. For this package, we
are using bootstrapping.</p>
<p>In general, bootstrapping refers to re-sampling from your original
data to create synthetic data sets with similar statistical properties,
then fitting the model to these new data sets. The parameter estimates
are recorded, and the variance in these estimates should be practical
for construction of a CI.</p>
<p>We <em>cannot</em> simply bootstrap the rows of the data in Table 1.
Each row represents a varying number of observations of the original
reads. For example, mutation C913T was observed 1191 times out of 2734
total short reads, and T16176C was observed 0 times out of 16765 short
reads. Randomly removing one of those rows would remove very different
amounts of information depending on which row is removed, and the
resulting estimates will not properly capture the confidence
interval.</p>
<p>Instead, the data should ideally be resampled on the original scale.
The row for mutation C913T should be converted into 2,734 rows, with
1,191 of those rows labelled TRUE and the rest false. This represents
the coverage of 2734 reads, of which 1191 had the mutation of interest.
This should be done for each mutation, then the resulting data frame
would be bootstrapped to find CI estimates.</p>
<p>This is computationally expensive, and a statistically equivalent
procedure is as follows. From the total number of reads in the data,
sample coverages proportionally using a multinomial distribution. If the
coverages for the positions of three mutations were 2,000, 2,000, 6,000
for three mutations, we would sample 10,000 observations from a
multinomial with probability of position 1 set to 20%, position 2 set to
20% and the third position set to 60%. This may result in, say, a
re-sampled coverage of 1953 at the first position, 2004 at the second,
and 6043 at the third. This is statistically equivalent to randomly
resampling a data set that has 2000 rows for position 1,2000 for
position 2, and 6000 for position 3.</p>
<p>The counts are then generated from a binomial distribution. In the
present example, suppose that 800 of the reads at position 1 contained
the mutation of interest, giving a frequency of 0.4%. The re-sampled
coverage is 1953, so we would sample a value from a binomial
distribution with 1953 trials and probability of success 0.4. This
procedure is implemented in <code>provoc</code>, and is equivalent to
the procedure implemented in Freyja (but developed independently).</p>
<p>To calculate a CI, this procedure is run at least 100 times. A 95%CI
is constructed by finding the middle 95% of each parameter estimate.</p>
</div>
<div class="section level4">
<h4 id="bias-due-to-improper-lineage-specification">Bias Due to Improper Lineage Specification<a class="anchor" aria-label="anchor" href="#bias-due-to-improper-lineage-specification"></a>
</h4>
<p>If we have too many lineages, there is bound to be a false positive.
Since the sum of the proportions cannot exceed 1, a false positive in
one place will necessarily take away from a positive (whether true or
false) in another. In other words, <em>bias increases with excess
lineages.</em></p>
<p>Conversely, suppose we are missing a lineage that should be present.
Under the assumption that this lineage shares mutations with another
lineage, the estimate of the other lineage will be biased upwards. In
other words, <em>bias increases with missing lineages.</em></p>
<p>For a concrete example, consider lineages A, B, and C with mutations
m1, m2, m3, and m4, as follows:</p>
<table class="table">
<thead><tr class="header">
<th>mutation</th>
<th>frequency</th>
<th>varA</th>
<th>varB</th>
<th>varC</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>m1</td>
<td>0.25</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
</tr>
<tr class="even">
<td>m2</td>
<td>0.5</td>
<td>yes</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="odd">
<td>m3</td>
<td>0.25</td>
<td>no</td>
<td>yes</td>
<td>no</td>
</tr>
<tr class="even">
<td>m4</td>
<td>0</td>
<td>no</td>
<td>no</td>
<td>yes</td>
</tr>
</tbody>
</table>
<p>In this example, we can guess that A and B have a proportion of 0.25,
while C has a proportion of 0. When A and B are both present, any
mutations they share are expected to be in 50% of the samples. However,
if we were to exlcude A, then we would get an estimate of 0.375 (the
average of the frequencies of mutations in lineage B). The erroneous
exclusion of A means that B’s estimate is biased upwards.</p>
<p>Conversely, suppose we included varC in our estimation. If the
proportion is estimated to be above 0, then the prediction for m1 would
be too high, so instead the model would need to reduce the estimate for
varA. The erroneous inlusion of C has biased A’s estimate downwards.</p>
<p>There is a another potential issue with including or excluding
lineages. In the table above we looked at mutations 1 through 4 because
they were present in lineages A, B, and C. If we introduced lineage D
which also included mutation 5, then we would be using another mutation
in the estimation procedure.</p>
<p>To detect these issues, <code>provoc</code> facilitates re-running
the analysis with different lineages to see the effect on the remaining
estimates.</p>
</div>
<div class="section level4">
<h4 id="lineage-importance-measures">Lineage Importance Measures<a class="anchor" aria-label="anchor" href="#lineage-importance-measures"></a>
</h4>
<p>In standard modelling approaches, Variance Inflation Factor is often
used to determine whether multiple predictors are measuring the same
thing. For example, if both height and weight are present in the data
set, both are measuring the size of the subject and the individual
effect of height or weight are difficult to ascertain.</p>
<p>For our present circumstances, all of our covariates are either 0 or
1, so the standard VIF caclulation does not apply. Instead, we check
similarity via various comparisons between two binary variables. We will
also extend this concept into groups of more than two lineages to check
whether one lineage can be expressed as a linear combination of other
lineages.</p>
</div>
<div class="section level4">
<h4 id="sensitivity-to-lineage-definitions">Sensitivity to Lineage Definitions<a class="anchor" aria-label="anchor" href="#sensitivity-to-lineage-definitions"></a>
</h4>
<p>In addition to being sensitive to the similarity between lineages,
the model results are sensitive to whether lineages were defined
correctly. The inclusion of, say C913T in B.1.1.7 may have been based on
99% of the lineages assigned to B.1.1.7 containing that mutation, or it
might come from 50% of lineages containing that mutation.</p>
<p>In usual linear regression diagnostics, there is a concept of
“influence” which measures how much an individual observation affects
the resultant parameters. In the bootstrap section, we were careful to
note that each row in Table 1 represents a varying amount of
observations, so it is inappropriate to use individual rows to test the
effects of observations.</p>
<p>We have two options: use the same concepts as the bootstrap method
(assume a multinomial for the coverage and then a binomial for the
counts, conditional on the coverage), or we can use the common
diagnostics and adjust them according to coverage.</p>
<p>For now, we take this second view. The influence of a mutation on the
parameter estimates can be calculated according to the so-called “hat”
matrix, which is <span class="math inline">\(X(X^TX)^{-1}X^T\)</span>.
The resulting influence can be divided by the count for a given
mutation, giving the influence per observation. This provides a single
value per mutation that can be interpreted according to the many
reads.</p>
<p>Future versions of this package will implement a “bagging” estimate
that properly addresses the aggregated nature of the data (a count
represents many observations), which allows for the calculation of the
influence of a mutation across many scenarios. This estimate is inspired
by random forests, in which the columns and the rows are
bootstrapped.</p>
</div>
<div class="section level4">
<h4 id="missing-lineages">Missing Lineages<a class="anchor" aria-label="anchor" href="#missing-lineages"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="model-only-diagnostics">Model-Only Diagnostics<a class="anchor" aria-label="anchor" href="#model-only-diagnostics"></a>
</h3>
<p>These methods apply if we only have access to the model outputs, not
the original data.</p>
<div class="section level4">
<h4 id="in-sample-predictive-accuracy">In-Sample Predictive Accuracy<a class="anchor" aria-label="anchor" href="#in-sample-predictive-accuracy"></a>
</h4>
<p>We can express our predictions according to all possible combinations
of the lineages. For three lineages, we have predictions for mutations
present in the first, second, or third lineage, but also for mutations
in the first and second, first and third, second and third, and all
three. Linear modelling assumes equal variance in the response for all
values of the response, and we can use our discrete set of responses to
directly assess this. From previous studies, it is known that there is
generally variation in excess of what our model would assume, especially
when normal distributions are assumed but also with binomial
distributions.</p>
</div>
<div class="section level4">
<h4 id="out-of-sample-predictive-accuracy">Out-of-Sample Predictive Accuracy<a class="anchor" aria-label="anchor" href="#out-of-sample-predictive-accuracy"></a>
</h4>
<p>If we have the model outputs and access to a new data set, we can
make predictions on that new data. We can use the full lineage
definitions matrix - even if a mutation was not present in the data used
to fit the model, the definition allows us to extrapolate to other
mutations.</p>
<p>In the example above, there were 27 mutations in the definitions that
were not used in the estimation. If these were present in a new data
set, we could still make predictions on them. This is an example of
extrapolation, and we have to be very careful that the proportions are
expected to be the same (i.e. we expect the same lineages to be
circulating at the same rate), and we must be careful when calculating
the variance (which depends on the coverage).</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="notes-on-implementation">Notes on Implementation<a class="anchor" aria-label="anchor" href="#notes-on-implementation"></a>
</h2>
<p>We end this document with some notes on the implementation of the
methods described above. The philosophy of the package is to work
similar to generalized linear models using the <code>mgcv</code>
package. We have created object classes so that users who are familiar
with the mgcv package are able to analyze the data as they would expect,
well also extending the analysis to the diagnostics that are particular
to lineage abundance estimation. We have created our own classes so that
methods work as expected and can easily be interoperated.</p>
<p>For example, results of Freyja can be loaded into our as a object of
type provoc, then all of the model-based diagnostics can be applied as
expected. We have implemented simplified versions of other modeling
approaches so that we can get approximate results using the exact same
methodology, including bootstrap confidence intervals and measures of
influence.</p>
<p>In conclusion, this package will make it easy to investigate the
input and output for models of lineage abundances from wastewater data.
This extends to models beyond the ones that we have developed, and the
package will be maintained and extended according to user feedback.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Devan Becker.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
