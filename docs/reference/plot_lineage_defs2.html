<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compare two lineage definition matrices"><title>Compare two lineage definition matrices — plot_lineage_defs2 • provoc</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compare two lineage definition matrices — plot_lineage_defs2"><meta property="og:description" content="Compare two lineage definition matrices"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">provoc</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Package_Overview.html">ProVoC Features</a>
    <a class="dropdown-item" href="../articles/mutation_definitions.html">Lineage Definitions in ProVoC</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Compare two lineage definition matrices</h1>
      
      <div class="d-none name"><code>plot_lineage_defs2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compare two lineage definition matrices</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_lineage_defs2</span><span class="op">(</span></span>
<span>  <span class="va">left_def</span>,</span>
<span>  <span class="va">right_def</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#b2182b"</span>, <span class="st">"#f7f7f7"</span>, <span class="st">"#2166ac"</span>, <span class="st">"grey90"</span>, <span class="st">"white"</span>, <span class="st">"grey40"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>left_def, right_def</dt>
<dd><p>Lineage definition matrices, such as those produced by <code><a href="astronomize.html">astronomize()</a></code> and <code><a href="usher_barcodes.html">usher_barcodes()</a></code>.Alternatively the output of <code><a href="provoc.html">provoc()</a></code>, from which the lineage definition matrix will be extracted (one may be a lineage definition matrix and the other may be the result of fitting provoc, allowing for comparison of which lineages/mutations were actually used).</p></dd>


<dt>col</dt>
<dd><p>A vector of three colours (left, middle, right). For a mutation present in <code>left_def</code> only, the colour will be the first colour in the vector, while a mutation not present will be 80% of the way between the left colour and the middle colour (similar for <code>right_def</code>). Optionally, the user can specify a vector of length 6, where the colours define left, middle, right, NA, neither, and both.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/r/stats/heatmap.html" class="external-link">heatmap()</a></code>, such as <code>main</code> for a title and <code>mar</code> to give the title space.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A darker colour means that the mutation is present in that lineage, whereas a lighter colour means it's absent.</p>
<p>The first colour in col represents mutation/lineage combinations that are only present in the left definitions, and the third color in col means it's only in the right.</p>
<p>The center square represents mutations and lineages that are present in both lineage definitions, with white indicating that the mutation is not present for that particular lineage and black indicating that it is present.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>heatmap()</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lineages</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B.1.1.7"</span>, <span class="st">"P.1"</span>, <span class="st">"B.1.617.1"</span>, <span class="st">"B.1.617.2"</span>, <span class="st">"B.1.617.3"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">left_def</span> <span class="op">&lt;-</span> <span class="fu"><a href="astronomize.html">astronomize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="filter_lineages.html">filter_lineages</a></span><span class="op">(</span><span class="va">lineages</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">right_def</span> <span class="op">&lt;-</span> <span class="fu"><a href="usher_barcodes.html">usher_barcodes</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="filter_lineages.html">filter_lineages</a></span><span class="op">(</span><span class="va">lineages</span><span class="op">[</span><span class="op">-</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in usher_barcodes():</span> could not find function "usher_barcodes"</span>
<span class="r-in"><span><span class="fu">plot_lineage_defs2</span><span class="op">(</span><span class="va">left_def</span>, <span class="va">right_def</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Constellations (without B.1.1.7) vs. Usher Barcodes (without P.1)"</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot_lineage_defs2(left_def, right_def, main = "Constellations (without B.1.1.7) vs. Usher Barcodes (without P.1)"):</span> object 'right_def' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_lineage_defs2</span><span class="op">(</span><span class="va">left_def</span>, <span class="va">right_def</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Constellations (without B.1.1.7) vs. Usher Barcodes (without P.1)"</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot_lineage_defs2(left_def, right_def, main = "Constellations (without B.1.1.7) vs. Usher Barcodes (without P.1)",     col = c(2, 0, 3)):</span> object 'right_def' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See which mutations/lineages were actually used</span></span></span>
<span class="r-in"><span><span class="va">lineage_defs</span> <span class="op">&lt;-</span> <span class="fu"><a href="astronomize.html">astronomize</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="filter_lineages.html">filter_lineages</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B.1.617.1"</span>, <span class="st">"B.1.617.2"</span>, <span class="st">"B.1.617.2+K417N"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"B.1.427"</span>, <span class="st">"B.1.429"</span>, <span class="st">"B.1.1.7"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="provoc.html">provoc</a></span><span class="op">(</span><span class="va">count</span> <span class="op">/</span> <span class="va">coverage</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">b1</span>,</span></span>
<span class="r-in"><span>    lineage_defs <span class="op">=</span> <span class="va">lineage_defs</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in provoc(count/coverage ~ ., data = b1, lineage_defs = lineage_defs):</span> object 'b1' not found</span>
<span class="r-in"><span><span class="co"># B.1.617.2 and B.1.617.2+K417N were "squashed" because they're identical.</span></span></span>
<span class="r-in"><span><span class="co"># We can also see which mutations were *not* used in the analysis.</span></span></span>
<span class="r-in"><span><span class="co"># They are the ones defined in the left_def but not present in right_def.</span></span></span>
<span class="r-in"><span><span class="fu">plot_lineage_defs2</span><span class="op">(</span><span class="va">lineage_defs</span>, <span class="va">res</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot_lineage_defs2(lineage_defs, res):</span> object 'res' not found</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Devan Becker.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

